# 2026-01-28 - Speed-to-Lead System V6

## What We Built Today

**Complete speed-to-lead pipeline for Mortar Metrics (law firm marketing)**

### System Components:
1. **research-v3-DEEP.js** - Deep research script that analyzes law firms
2. **report-generator-v6.js** - Generates personalized landing pages
3. **Competitor intelligence** - Manual research + automated display

### Key Files:
- `/Users/fardeenchoudhury/clawd/speed-to-lead/research-v3-DEEP.js`
- `/Users/fardeenchoudhury/clawd/speed-to-lead/report-generator-v6.js`
- Research output: `./reports/{firm-slug}-research.json`
- Landing pages: `./reports/{firm-slug}-landing-page.html`

## How It Works:

### 1. Research Phase
```bash
node research-v3-DEEP.js "https://www.firmwebsite.com" "Contact Name"
```
- Analyzes homepage, about, team, contact pages
- Checks page speed (target: <2s)
- Detects gaps: Google Ads, Meta Ads, 24/7 support, reviews, CRM
- Calculates monthly revenue loss per gap

### 2. Competitor Research (Manual for now)
- Google search: "[practice area] lawyer [city]"
- Find 8-10 competitors
- Note their features (Google Ads, Meta Ads, 24/7 AI, reviews)
- Add to research JSON manually

### 3. Generate Landing Page
```bash
node report-generator-v6.js ./reports/{firm}-research.json "Prospect Name"
```

## Critical Learnings:

### Competitor Display Must Show VARIATION
**DON'T** show all competitors doing everything (unrealistic)
**DO** show tiered competition:
- **2-3 top competitors**: High reviews, ads + 24/7 (stealing most)
- **5-6 medium competitors**: Mixed strategies (some ads, some 24/7, not both)
- **2-3 similar/behind**: Low reviews, missing both (like the prospect)

### Variation Pattern (in report-generator-v6.js):
```javascript
const variationPatterns = [
  { googleAds: true, support24x7: true, tier: 'strong' },     // Top
  { googleAds: true, support24x7: true, tier: 'strong' },     // Top
  { googleAds: true, support24x7: false, tier: 'medium' },    // Medium
  { googleAds: false, support24x7: true, tier: 'medium' },    // Medium
  { googleAds: true, support24x7: true, tier: 'medium' },     // Medium
  { googleAds: false, support24x7: false, tier: 'similar' },  // Similar
  { googleAds: true, support24x7: false, tier: 'medium' },    // Bit better
  { googleAds: false, support24x7: true, tier: 'medium' },    // Bit better
  { googleAds: false, support24x7: false, tier: 'similar' },  // Similar
];
```

### Show Actual Firm Data
- **Reviews**: Show actual count (9, 15, 42, etc.) not "Low/Good"
- **Google Ads**: Yes/No based on their actual gaps
- **24/7 Support**: Yes/No based on their actual gaps

## Example We Completed:

**Firm**: Allen & Kimbell, LLP (Santa Barbara estate planning)
**Contact**: Paul A. Graziano
**Monthly Loss**: $51K
**Gaps**: No Google Ads, No Meta Ads, No 24/7 support, slow website, no CRM

**9 Competitors Found**:
1. Santa Barbara Estate Planning & Elder Law (104 reviews, 5.0★)
2. Montecito Law Group, P.C. (232 reviews, 5.0★)
3. Santa Barbara Estate Planner
4. Mullen & Henzell
5. Rogers, Sheffield & Campbell
6. Miller & Berryhill
7. Collins & Associates
8. Botti & Morison
9. Fennemore (Gamble Parks)

**Landing Page**: Shows competitor table with variation, problems costing $8-15K/mo each, solutions with timelines, case study, CTA to book call.

## Files Modified Today:
- `/Users/fardeenchoudhury/clawd/speed-to-lead/report-generator-v6.js` - Fixed competitor display variation
- `/Users/fardeenchoudhury/clawd/speed-to-lead/reports/allen---kimbell--llp-research.json` - Added 9 competitors
- `/Users/fardeenchoudhury/clawd/speed-to-lead/reports/allen---kimbell--llp-landing-page.html` - Generated

## Next Steps:
Ready to process new leads using the same system.

## CRITICAL BUG FOUND - Research Script False Positives

**Issue:** The research script (`research-v3-DEEP.js`) has false positive detection for chatbots:
```javascript
const hasChatbot = await page.locator('[class*="chat"], [id*="chat"]').count() > 0;
```

**Problem:** It flags any HTML element with "chat" in the class/id as a chatbot, even if it's not an actual chat widget.

**Example:** keylaw.com was flagged as having a chatbot, but it doesn't. The script detected something with "chat" in the HTML (maybe an image, CSS class, etc.).

**Fix needed:** Better detection - look for actual chat widget embeds:
- Intercom (`#intercom-container`)
- Drift (`#drift-widget`)
- Tidio (`.tidio-chat-iframe`)
- LiveChat (`#chat-widget-container`)
- Or check for chat iframe embeds

**Lesson:** NEVER trust research data blindly. Verify claims before writing them in reports. Stefan caught this immediately because we claimed he had something he didn't.

## Report Generator V7 - NEW VOICE (Complete Rebuild)

**Created:** 2026-01-29

**What we built:**
- Complete rewrite of report generator based on perfected Stefan template
- Conversational "we/our" team language throughout
- Tool flexing (competitive intelligence platform, keyword tools, benchmark tool)
- Toronto positioning ("we're based in Toronto too")
- Only uses VERIFIED data from research JSON (no bullshit claims)

**Key Features:**
1. **Visual Structure:**
   - Strength boxes (green) for what they're doing right
   - Gap boxes with cost badges for problems
   - Stat highlights for key numbers
   - Big dividers between major sections
   - Section dividers for smaller breaks

2. **Competitor Analysis:**
   - Deep dives on top 3 competitors (not generic tables)
   - Shows what they're doing well
   - Shows where opportunities are
   - Honest assessment (not made-up claims)

3. **Solution Packages (Varied):**
   - **Package 1:** Google Ads + Retargeting (+$XK/mo)
   - **Package 2:** Voice AI + CRM (+$XK/mo)
   - **Package 3:** Full System (all combined)
   - Each with timeline, investment, expected results

4. **Credibility Section:**
   - "20+ law firms, $400K ad spend, $2.1M+ in new cases closed"
   - Stat highlight for $2.1M+
   - No pitch deck, no pressure

5. **Mortar Metrics Booking Widget:**
   - Embedded iframe at bottom
   - Auto-resizing script

**Research Script Fix:**
- Fixed chatbot detection (looks for actual widgets like Intercom, Drift, Tidio, LiveChat)
- No more false positives from random "chat" in HTML class names

**Files:**
- `/Users/fardeenchoudhury/clawd/speed-to-lead/research-v3-DEEP.js` (updated)
- `/Users/fardeenchoudhury/clawd/speed-to-lead/report-generator-v7.js` (new)

**Usage:**
```bash
node research-v3-DEEP.js "https://firmwebsite.com" "Contact Name"
node report-generator-v7.js ./reports/firm-research.json "Contact Name"
```

**Ready for production use.**

## Research Script Fixes - 2026-01-29 (Critical Improvements)

**Fixed 4 major issues:**

### 1. 24/7 Support Detection (Fixed False Positives)
**Problem:** Matching generic "24 hours" in "respond within 24 hours"
**Fix:** 
- Changed to specific phrases: "available 24/7", "open 24/7", "24/7 answering", "call us 24/7"
- Excludes phrases like "within 24 hours" and "respond in 24"
- More accurate detection of actual 24/7 answering services

### 2. Facebook Page ID Extraction (7 Methods)
**Problem:** Couldn't extract Page ID from Facebook pages
**Fix:** Added 7 extraction methods:
1. URL pattern: `?id=123456`
2. `"page_id":"123456"`
3. `"pageID":"123456"`
4. `"entity_id":"123456"`
5. `"owning_profile":{"__typename":"Page","id":"123456"}`
6. `"contentID":"123456"`
7. Meta tags: `al:android:url`
8. Frequency analysis of 15-16 digit numbers in page source

### 3. Google Ads Ad Count (Better Detection)
**Problem:** Detecting presence but not counting ads
**Fix:**
- Increased wait time to 5000ms for ads to load
- Added multiple selectors to find ad cards
- Better "no ads" message detection
- More reliable ad counting

### 4. Competitor Finding (Improved Extraction)
**Problem:** Not finding any competitors
**Fix:**
- Extract from both h3 tags (titles) and snippets
- Improved regex pattern for law firm names
- Better name cleaning (remove articles, extra spaces)
- Case-insensitive duplicate detection
- Finds up to 12 competitors

**Files updated:**
- `/Users/fardeenchoudhury/clawd/speed-to-lead/research-v3-DEEP.js`

**Ready for thorough, accurate research.**
